# GM - Size Class

Two `size classes` (large/small) were used to examine whether the morphology of the elliptical bifaces from the Millsap Cache and Jowell Farm remain morphologically stable, or express morphological variation. Variability in elliptical biface morphology potentially provides evidence associated with differential resharpening trajectories.

This analysis follows recent analyses of Perdiz arrow points ([Selden and Dockall, in review](https://github.com/seldenlab/perdiz3/blob/main/ms/perdiz3/perdiz3.pdf)) and Gahagan biface morphology across the southern Caddo area and central Texas [@RN11783;@RN21001;@RN11264], where Perdiz arrow points and Gahagan bifaces have been found to differ in shape across the same geography as Caddo bottles [@RN11801;@RN11782;@RN11716;@RN8312]. This analysis also follows another geometric morphometric analysis in which Perdiz arrow points from the ancestral Caddo area were found to differ as a function of _time_, _raw material_, and _burial context_ [@RN9551].

## Load packages + data

```{r load.packages, out.width = "100%", dpi = 300, echo=TRUE, warning=FALSE}
# load required analysis packages
library(here)
library(StereoMorph)
library(geomorph)
library(tidyverse)
library(wesanderson)
library(ggplot2)

# read qualitative data
qdata <- read.csv("qdata.merged.csv", 
                  header = TRUE, 
                  row.names = 1)
```

## Generalised Procrustes Analysis

Landmark data were aligned to a global coordinate system [@RN11622;@RN11623;@RN11563], achieved through generalized Procrustes superimposition [@RN478] performed in R 4.1.3 [@R] using the `geomorph` library v. 4.0.3 [@RN11530;@RN1774;@RN9565]. Procrustes superimposition translates, scales, and rotates the coordinate data to allow for comparisons among objects [@RN11564;@RN478]. The `geomorph` package uses a partial Procrustes superimposition that projects the aligned specimens into tangent space subsequent to alignment in preparation for the use of multivariate methods that assume linear space [@RN1646;@RN11563]. 

```{r outlines, out.width = "100%", dpi = 300, echo=TRUE, warning=FALSE}
# gpa ----
Y.gpa <- gpagen(shapesGM, print.progress = FALSE)

# geomorph data frame ----
gdf <- geomorph.data.frame(shape = Y.gpa$coords, 
                           size = Y.gpa$Csize,
                           site = qdata$site,
                           size.class = qdata$size,
                           merged = qdata$merged)


# add centroid size to qdata
qdata$csz <- Y.gpa$Csize
```

## Principal Components Analysis

Principal components analysis [@RN1746] was used to visualise shape variation among the Perdiz arrow points. The shape changes described by each principal axis are commonly visualized using thin-plate spline warping of a reference 3D mesh [@RN1731;@RN479].


```{r pca.plot, out.width = "100%", dpi = 300, echo=TRUE, warning=FALSE}
# principal components analysis ----
pca<-gm.prcomp(Y.gpa$coords)
summary(pca)

# set plot parameters
pch.gps <- c(1:4)[as.factor(qdata$merged)]
col.gps <- wes_palette("Moonrise2")[as.factor(qdata$merged)]
col.hull <- c("#CCC591", "#29211F", "#798E87", "#C27D38")

# plot pca by merged
pc.plot <- plot(pca, 
                asp = 1,
                pch = pch.gps,
                col = col.gps)
shapeHulls(pc.plot, 
           groups = qdata$merged,
           group.cols = col.hull)
```

## Procrustes ANOVA

To assess whether shape and size differ by `size class`, Procrustes ANOVAs [@RN1749] were run that enlist effect-sizes (zscores) computed as standard deviates of the generated sampling distributions [@RN1756]. A residual randomization permutation procedure (RRPP; n = 10,000 permutations) was used for all Procrustes ANOVAs [@RN1655;@RN11775], which has higher statistical power and a greater ability to identify patterns in the data should they be present [@RN1719].


```{r anova, out.width = "100%", dpi = 300, echo=TRUE, warning=FALSE}
# ANOVA ----
# shape
fit.sh <- procD.lm(shape ~ merged,
                   data = gdf,
                   print.progress = FALSE,
                   iter = 9999)

# shape as a function of size class?
anova(fit.sh)

# size
fit.sz <- procD.lm(size ~ merged,
                   data = gdf,
                   print.progress = FALSE,
                   iter = 9999)

# size as a function of size class?
anova(fit.sz)

# pairwise comparison of LS means = which differ?
pw.sz <- pairwise(fit.sz,
                  groups = qdata$merged)
summary(pw.sz, 
        confidence = 0.95, 
        test.type = "dist")
```

## Morphological Disparity

An analysis of morphological disparity was used [@RN11107;@RN7041;@RN5694] to identify potential differences in morphological diversity between the size classes.

```{r mdisp, out.width = "100%", dpi = 300, echo=TRUE, warning=FALSE}
# morphological disparity ----
# do any of the groups display greater shape variation among 
# individuals relative to the other group?
morphol.disparity(shape ~ merged,
                  groups = qdata$merged, 
                  data = gdf, 
                  print.progress = FALSE, 
                  iter = 9999)

# do any of the groups display greater size variation among 
# individuals relative to the other group?
morphol.disparity(size ~ merged,
                  groups = qdata$merged, 
                  data = gdf, 
                  print.progress = FALSE, 
                  iter = 9999)
```
