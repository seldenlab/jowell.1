[["linear-metrics-by-site.html", "Chapter 1 Linear metrics by site 1.1 Set working directory, load data, and define variables 1.2 Boxplots for variable by site 1.3 Ternary plot 1.4 Principal Components Analysis for site 1.5 Density plots for variable ~ group 1.6 Analyses of Variance (ANOVA) for variable ~ site", " Chapter 1 Linear metrics by site # install required analysis packages #devtools::install_github(&quot;tidyverse/tidyverse&quot;) #devtools::install_github(&quot;mlcollyer/RRPP&quot;) #devtools::install_github(&quot;kassambara/ggpubr&quot;) #devtools::install_github(&quot;sinhrks/ggfortify&quot;) #devtools::install_git(&#39;https://bitbucket.org/nicholasehamilton/ggtern&#39;) #devtools::install_github(&quot;karthik/wesanderson&quot;) #devtools::install_github(&quot;daattali/ggExtra&quot;) # load libraries library(tidyverse) ## -- Attaching packages ---------------------------------- tidyverse 1.3.1.9000 -- ## v ggplot2 3.3.5 v purrr 0.3.4 ## v tibble 3.1.6 v dplyr 1.0.8 ## v tidyr 1.2.0 v stringr 1.4.0 ## v readr 2.1.2 v forcats 0.5.1 ## -- Conflicts ------------------------------------------ tidyverse_conflicts() -- ## x dplyr::filter() masks stats::filter() ## x dplyr::lag() masks stats::lag() library(RRPP) library(ggpubr) library(ggfortify) library(ggtern) ## Registered S3 methods overwritten by &#39;ggtern&#39;: ## method from ## grid.draw.ggplot ggplot2 ## plot.ggplot ggplot2 ## print.ggplot ggplot2 ## -- ## Remember to cite, run citation(package = &#39;ggtern&#39;) for further info. ## -- ## ## Attaching package: &#39;ggtern&#39; ## The following objects are masked from &#39;package:ggplot2&#39;: ## ## aes, annotate, ggplot, ggplot_build, ggplot_gtable, ggplotGrob, ## ggsave, layer_data, theme_bw, theme_classic, theme_dark, ## theme_gray, theme_light, theme_linedraw, theme_minimal, theme_void library(cluster) library(wesanderson) library(ggExtra) 1.1 Set working directory, load data, and define variables # set working directory setwd(getwd()) data &lt;- read.csv(&quot;linear.csv&quot;, header = TRUE, as.is=TRUE) # define variables maxl &lt;- data$length # maximum length maxw &lt;- data$width# maximum width maxth &lt;- data$thickness # maximum thickness site &lt;- data$site # site name 1.2 Boxplots for variable by site # boxplot of maximum length ~ site sitemaxl &lt;- ggplot(data, aes(x = site, y = maxl, color = site)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;, stackdir = &#39;center&#39;, dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + theme(legend.position = &quot;none&quot;) + labs(x = &#39;Site&#39;, y = &#39;MaxL&#39;) # boxplot of maximum width ~ site sitemaxw &lt;- ggplot(data, aes(x = site, y = maxw, color = site)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;, stackdir = &#39;center&#39;, dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + theme(legend.position = &quot;none&quot;) + labs(x = &#39;Site&#39;, y = &#39;MaxW&#39;) # boxplot of maximum thickness ~ site sitemaxth &lt;- ggplot(data, aes(x = site, y = maxth, color = site)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;, stackdir = &#39;center&#39;, dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + theme(legend.position = &quot;none&quot;) + labs(x = &#39;Site&#39;, y = &#39;MaxTh&#39;) # render figure sitefigure&lt;-ggarrange(sitemaxl,sitemaxw,sitemaxth, labels = c(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;), ncol = 2, nrow = 2) ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. # plot figure sitefigure Figure 1.1: Boxplots for maximum length, width, and thickness for Jowell knives from 41AN13 and 41HS261. 1.3 Ternary plot #attributes for plot df &lt;- data[c(3:5)] pch.gps.gp &lt;- c(15,19)[as.factor(site)] col.gps.gp &lt;- wes_palette(&quot;Moonrise2&quot;)[as.factor(site)] # load data tern &lt;- ggtern(data = data, aes(maxl, maxw, maxth)) + geom_point(shape = pch.gps.gp, col = col.gps.gp) + scale_T_continuous(limits = c(0, 0.2)) + scale_L_continuous(limits = c(0.8, 1)) + scale_R_continuous(limits = c(0, 0.2)) # render plot tern 1.4 Principal Components Analysis for site #pca pca &lt;- autoplot(prcomp(df), data = data, asp = 1, shape = pch.gps.gp, colour = &#39;site&#39;, loadings = TRUE, loadings.colour = &#39;blue&#39;, loadings.label = TRUE, loadings.label.size = 3, frame = TRUE) + scale_fill_manual(values = wes_palette(&quot;Moonrise2&quot;)) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) ggMarginal(pca, groupColour = TRUE, groupFill = TRUE) Figure 1.2: Principal Components Analysis by site. 1.5 Density plots for variable ~ group # density plot for maxl by site ggplot(data, aes(x = maxl, fill = site, colour = site)) + geom_density(alpha = .5) + scale_fill_manual(values = wes_palette(&quot;Moonrise2&quot;)) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + xlim(0,150) + labs(x = &#39;Max Length&#39;, y = &#39;density&#39;) # density plot for maxw by site ggplot(data, aes(x = maxw, fill = site, colour = site)) + geom_density(alpha = .4) + scale_fill_manual(values = wes_palette(&quot;Moonrise2&quot;)) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + xlim(0,75) + labs(x = &#39;Max Width&#39;, y = &#39;density&#39;) # density plot for maxth by site ggplot(data, aes(x = maxth, fill = site, colour = site)) + geom_density(alpha = .4) + scale_fill_manual(values = wes_palette(&quot;Moonrise2&quot;)) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + xlim(0,25) + labs(x = &#39;Max Thickness&#39;, y = &#39;density&#39;) 1.6 Analyses of Variance (ANOVA) for variable ~ site 1.6.1 Maximum length of Jowell knives # anova = maximum length ~ site siteml &lt;- lm.rrpp(maxl ~ site, SS.type = &quot;I&quot;, data = data, iter = 9999, print.progress = FALSE) anova(siteml) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## site 1 113.6 113.62 0.01963 0.7407 0.32984 0.3938 ## Residuals 37 5675.5 153.39 0.98037 ## Total 38 5789.1 ## ## Call: lm.rrpp(f1 = maxl ~ site, iter = 9999, SS.type = &quot;I&quot;, data = data, ## print.progress = FALSE) 1.6.2 Maximum width of Jowell knives # anova = maximum width ~ site sitemw &lt;- lm.rrpp(maxw ~ site, SS.type = &quot;I&quot;, data = data, iter = 9999, print.progress = FALSE) anova(sitemw) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## site 1 0.113 0.11292 0.00202 0.0748 -0.84786 0.7885 ## Residuals 37 55.837 1.50911 0.99798 ## Total 38 55.950 ## ## Call: lm.rrpp(f1 = maxw ~ site, iter = 9999, SS.type = &quot;I&quot;, data = data, ## print.progress = FALSE) 1.6.3 Maximum thickness of Jowell knives # anova = maximum thickness ~ site sitemth &lt;- lm.rrpp(maxth ~ site, SS.type = &quot;I&quot;, data = data, iter = 9999, print.progress = FALSE) anova(sitemth) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## site 1 15.275 15.2749 0.46124 31.676 3.7951 1e-04 *** ## Residuals 37 17.842 0.4822 0.53876 ## Total 38 33.117 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: lm.rrpp(f1 = maxth ~ site, iter = 9999, SS.type = &quot;I&quot;, data = data, ## print.progress = FALSE) "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
