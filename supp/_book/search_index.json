[["index.html", "Caddo retouch results in convergent morphology for Jowell knives from sites in the American Southeast Preface 0.1 Primary findings 0.2 Acknowledgments 0.3 Funding 0.4 Data management 0.5 Colophon", " Caddo retouch results in convergent morphology for Jowell knives from sites in the American Southeast Robert Z. Selden, Jr.1 2022-07-06 Preface Reproducibility—the ability to recompute results—and replicability—the chances other experimenters will achieve a consistent result—are two foundational characteristics of successful scientific research (Leek and Peng 2015). Jowell knives from 41AN13 and 41HS261 comprise the two largest samples of this ill-understood lithic type from the ancestral Caddo area. All are thought to have been manufactured using Edwards chert, and acquired by the Caddo through trade with central Texas groups. Due to the very real possibility that these knives incorporate unique knapping signatures from two discrete culture areas, the sample from each site was divided into two size classes; one reflective of Caddo selection/preference (longer), and the other associated with Caddo resharpening and/or retouch (shorter). The size classes were used to assess whether modifications by Caddo knappers yielded similar—convergent—knife shape in the smaller size class, and to test the hypothesis that greater shape variation would also be apparent in the smaller size class due to wear associated with regular use, paired with variable idiosyncracies related to resharpening and/or retouch. The large and small size classes were found to be significantly thicker at 41HS261, suggesting a local preference for thicker knives. While the shape of Jowell knives from the large size class differed significantly between sites, the small size class did not, advancing the argument for convergent morphology. In contrast to the expectation that greater shape diversity would articulate with Caddo resharpening and/or retouch practices, significant diversity in shape was instead found to articulate with Caddo selection/preference. knitr::include_graphics(&#39;./images/jowell.map.png&#39;) Figure 0.1: Location of 41AN13 and 41HS261 in the ancestral Caddo area (in white) of the American Southeast. knitr::include_graphics(&#39;./images/jowell.illustration.png&#39;) Figure 0.2: Illustration of Jowell knives from 41AN13 and 41HS261, ordered by length. 0.1 Primary findings 0.1.1 Linear metrics Linear metrics were used to assess differences in width and thickness within and between size classes. Since maximum length was used to parse the sample, it was omitted from the ANOVAs. Large Jowell knives from 41AN13 and 41HS261 differ significantly in thickness Small Jowell knives from 41AN13 and 41HS261 differ significantly in thickness Thus, while thickness differs for size classes between sites, it does not differ between the large and small size classes within sites. This result supports the interpretation that the Caddo from 41HS261 preferred a thicker knife; at least, insofar as they appear to have been selecting for—and maintaining—a product that was significantly thicker. knitr::include_graphics(&#39;./images/pcalinear.png&#39;) Figure 0.3: PCA of linear measures for Jowell knives from 41AN13_L/S and 41HS261_L/S. knitr::include_graphics(&#39;./images/boxplot.png&#39;) Figure 0.4: Boxplots for linear measurements associated with Jowell knives from 41AN13 and 41HS261. 0.1.2 Geometric morphometrics Geometric morphometrics was used to assess differences in size and shape within and between size classes. Jowell knives recovered at 41AN13 and 41HS261 differ significantly in shape at their larger size Morphological disparity is significantly greater in the large size class at 41AN13 The shape of Jowell knives differs significantly at their larger size, but not at their smaller size, supporting the argument for convergent morphology through Caddo resharpening and/or retouch. While not significant, the graphic associated with the phenotypic trajectory analysis also illustrates morphological convergence. Results for the analysis of morphological disparity demonstrate the inverse of what was expected, supporting the interpretation that greater shape diversity is associated with Caddo selection/preference, instead of Caddo resharpening and/or retouch practices. knitr::include_graphics(&#39;./images/pca.png&#39;) Figure 0.5: PCA of shape variables for Jowell knives from 41AN13_L/S and 41HS261_L/S. knitr::include_graphics(&#39;./images/trajectory.png&#39;) Figure 0.6: Resharpening trajectories do not differ, and illustrate convergent morphology as Jowell knives express greater morphological similarity following resharpening and/or retouch by Caddo knappers. 0.2 Acknowledgments My thanks to the Caddo Nation of Oklahoma, the Caddo Nation Tribal Council, Tribal Chairman, and Tribal Historic Preservation Office for permission and access to NAGPRA and previously repatriated collections. My gratitude is also extended to Julian A. Sitters and Timothy K. Perttula for providing the linear measurements and images from their documentation effort. Thanks also to John Harman for access to the DStretch plugin for ImageJ that was useful in the analysis of flake scars, and to Harry J. Shafer, Hiram F. (Pete) Gregory, Christian S. Hoggard, and David K. Thulman for their comments and constructive criticisms on the analyses of Caddo biface morphology, and to Emma Sherratt, Kersten Bergstrom, Dean C. Adams, and Michael L. Collyer for their constructive criticisms, general comments, and suggestions throughout the development of this research program. 0.3 Funding Components of this analytical work flow were developed and funded by a Preservation Technology and Training grant (P14AP00138) to RZS from the National Center for Preservation Technology and Training (NCPTT), and additional grants to RZS from the Caddo Nation of Oklahoma, National Forests and Grasslands in Texas (15-PA-11081300-033) and the United States Forest Service (20-PA-11081300-074). Funding to analyse the Jowell knives from 41AN13 and 41HS261 was provided by the Heritage Research Center at Stephen F. Austin State University. 0.4 Data management The analysis code associated with this project can be accessed through this document, is available in the GitHub repository, and is digitally curated on the Open Science Framework. The reproducible nature of this enterprise provides a means for others to critically assess and evaluate the various analytical components (Gray and Marwick 2019; Peng 2011; Gandrud 2014), which is a necessary requirement for the production of reliable knowledge. Reproducibility projects in psychology and cancer biology are impacting current research practices across all domains. Examples of reproducible research are becoming more abundant in archaeology (Marwick 2016; Ivanovaite et al. 2020; Selden Jr., Dockall, and Shafer 2018; Selden Jr., Dockall, and Dubied 2020; Selden Jr et al. 2021), and the next generation of archaeologists are learning those tools and methods needed to reproduce and/or replicate research results (Marwick et al. 2019). Reproducible and replicable research work flows are often employed at the highest levels of humanities-based inquiries to mitigate concern or doubt regarding proper execution, and is of particular import should the results have—explicitly or implicitly—a major impact on scientific progress (Peels and Bouter 2018). 0.5 Colophon This version of the analysis was generated on 2022-07-06 10:31:23 using the following computational environment and dependencies: # what R packages and versions were used? if (&quot;devtools&quot; %in% installed.packages()) devtools::session_info() ## ─ Session info ───────────────────────────────────────────────────────── ## setting value ## version R version 4.2.0 (2022-04-22 ucrt) ## os Windows 10 x64 (build 19044) ## system x86_64, mingw32 ## ui RStudio ## language (EN) ## collate English_United States.utf8 ## ctype English_United States.utf8 ## tz America/Chicago ## date 2022-07-06 ## rstudio 2022.02.3+492 Prairie Trillium (desktop) ## pandoc 2.17.1.1 @ C:/Program Files/RStudio/bin/quarto/bin/ (via rmarkdown) ## ## ─ Packages ───────────────────────────────────────────────────────────── ## package * version date (UTC) lib source ## abind 1.4-5 2016-07-21 [1] CRAN (R 4.2.0) ## ape 5.6-2 2022-03-02 [1] CRAN (R 4.2.0) ## assertthat 0.2.1 2019-03-21 [1] CRAN (R 4.2.0) ## backports 1.4.1 2021-12-13 [1] CRAN (R 4.2.0) ## bookdown 0.27 2022-06-14 [1] CRAN (R 4.2.1) ## broom 1.0.0 2022-07-01 [1] CRAN (R 4.2.1) ## bslib 0.3.1 2021-10-06 [1] CRAN (R 4.2.0) ## cachem 1.0.6 2021-08-19 [1] CRAN (R 4.2.0) ## callr 3.7.0 2021-04-20 [1] CRAN (R 4.2.0) ## car 3.1-0 2022-06-15 [1] CRAN (R 4.2.1) ## carData 3.0-5 2022-01-06 [1] CRAN (R 4.2.0) ## cellranger 1.1.0 2016-07-27 [1] CRAN (R 4.2.0) ## cli 3.3.0 2022-04-25 [1] CRAN (R 4.2.0) ## colorspace 2.0-3 2022-02-21 [1] CRAN (R 4.2.0) ## crayon 1.5.1 2022-03-26 [1] CRAN (R 4.2.0) ## DBI 1.1.3 2022-06-18 [1] CRAN (R 4.2.1) ## dbplyr 2.2.1 2022-06-27 [1] CRAN (R 4.2.1) ## devtools 2.4.3 2021-11-30 [1] CRAN (R 4.2.0) ## digest 0.6.29 2021-12-01 [1] CRAN (R 4.2.0) ## dplyr * 1.0.9 2022-04-28 [1] CRAN (R 4.2.0) ## ellipsis 0.3.2 2021-04-29 [1] CRAN (R 4.2.0) ## evaluate 0.15 2022-02-18 [1] CRAN (R 4.2.0) ## fansi 1.0.3 2022-03-24 [1] CRAN (R 4.2.0) ## fastmap 1.1.0 2021-01-25 [1] CRAN (R 4.2.0) ## forcats * 0.5.1 2021-01-27 [1] CRAN (R 4.2.0) ## fs 1.5.2 2021-12-08 [1] CRAN (R 4.2.0) ## generics 0.1.3 2022-07-05 [1] CRAN (R 4.2.0) ## ggfortify * 0.4.14 2022-01-03 [1] CRAN (R 4.2.0) ## ggplot2 * 3.3.6 2022-05-03 [1] CRAN (R 4.2.0) ## ggpubr * 0.4.0 2020-06-27 [1] CRAN (R 4.2.0) ## ggsignif 0.6.3 2021-09-09 [1] CRAN (R 4.2.0) ## git2r 0.30.1 2022-03-16 [1] CRAN (R 4.2.0) ## glue 1.6.2 2022-02-24 [1] CRAN (R 4.2.0) ## gridExtra 2.3 2017-09-09 [1] CRAN (R 4.2.0) ## gtable 0.3.0 2019-03-25 [1] CRAN (R 4.2.0) ## haven 2.5.0 2022-04-15 [1] CRAN (R 4.2.0) ## here * 1.0.1 2020-12-13 [1] CRAN (R 4.2.0) ## highr 0.9 2021-04-16 [1] CRAN (R 4.2.0) ## hms 1.1.1 2021-09-26 [1] CRAN (R 4.2.0) ## htmltools 0.5.2 2021-08-25 [1] CRAN (R 4.2.0) ## httr 1.4.3 2022-05-04 [1] CRAN (R 4.2.0) ## jquerylib 0.1.4 2021-04-26 [1] CRAN (R 4.2.0) ## jsonlite 1.8.0 2022-02-22 [1] CRAN (R 4.2.0) ## knitr 1.39 2022-04-26 [1] CRAN (R 4.2.0) ## lattice 0.20-45 2021-09-22 [2] CRAN (R 4.2.0) ## lifecycle 1.0.1 2021-09-24 [1] CRAN (R 4.2.0) ## lubridate 1.8.0 2021-10-07 [1] CRAN (R 4.2.0) ## magrittr 2.0.3 2022-03-30 [1] CRAN (R 4.2.0) ## Matrix 1.4-1 2022-03-23 [2] CRAN (R 4.2.0) ## memoise 2.0.1 2021-11-26 [1] CRAN (R 4.2.0) ## modelr 0.1.8 2020-05-19 [1] CRAN (R 4.2.0) ## munsell 0.5.0 2018-06-12 [1] CRAN (R 4.2.0) ## nlme 3.1-157 2022-03-25 [2] CRAN (R 4.2.0) ## pillar 1.7.0 2022-02-01 [1] CRAN (R 4.2.0) ## pkgbuild 1.3.1 2021-12-20 [1] CRAN (R 4.2.0) ## pkgconfig 2.0.3 2019-09-22 [1] CRAN (R 4.2.0) ## pkgload 1.3.0 2022-06-27 [1] CRAN (R 4.2.1) ## png 0.1-7 2013-12-03 [1] CRAN (R 4.2.0) ## prettyunits 1.1.1 2020-01-24 [1] CRAN (R 4.2.0) ## processx 3.6.1 2022-06-17 [1] CRAN (R 4.2.1) ## ps 1.7.1 2022-06-18 [1] CRAN (R 4.2.1) ## purrr * 0.3.4 2020-04-17 [1] CRAN (R 4.2.0) ## R6 2.5.1 2021-08-19 [1] CRAN (R 4.2.0) ## Rcpp 1.0.8.3 2022-03-17 [1] CRAN (R 4.2.0) ## readr * 2.1.2 2022-01-30 [1] CRAN (R 4.2.0) ## readxl 1.4.0 2022-03-28 [1] CRAN (R 4.2.0) ## remotes 2.4.2 2021-11-30 [1] CRAN (R 4.2.0) ## reprex 2.0.1 2021-08-05 [1] CRAN (R 4.2.0) ## rlang 1.0.3 2022-06-27 [1] CRAN (R 4.2.1) ## rmarkdown 2.14 2022-04-25 [1] CRAN (R 4.2.0) ## rprojroot 2.0.3 2022-04-02 [1] CRAN (R 4.2.0) ## RRPP * 1.3.0 2022-04-01 [1] Github (mlcollyer/RRPP@7f0f0f9) ## rstatix 0.7.0 2021-02-13 [1] CRAN (R 4.2.0) ## rstudioapi 0.13 2020-11-12 [1] CRAN (R 4.2.0) ## rvest 1.0.2 2021-10-16 [1] CRAN (R 4.2.0) ## sass 0.4.1 2022-03-23 [1] CRAN (R 4.2.0) ## scales 1.2.0 2022-04-13 [1] CRAN (R 4.2.0) ## sessioninfo 1.2.2 2021-12-06 [1] CRAN (R 4.2.0) ## stringi 1.7.6 2021-11-29 [1] CRAN (R 4.2.0) ## stringr * 1.4.0 2019-02-10 [1] CRAN (R 4.2.0) ## tibble * 3.1.7 2022-05-03 [1] CRAN (R 4.2.0) ## tidyr * 1.2.0 2022-02-01 [1] CRAN (R 4.2.0) ## tidyselect 1.1.2 2022-02-21 [1] CRAN (R 4.2.0) ## tidyverse * 1.3.1 2021-04-15 [1] CRAN (R 4.2.0) ## tzdb 0.3.0 2022-03-28 [1] CRAN (R 4.2.0) ## usethis 2.1.6 2022-05-25 [1] CRAN (R 4.2.0) ## utf8 1.2.2 2021-07-24 [1] CRAN (R 4.2.0) ## vctrs 0.4.1 2022-04-13 [1] CRAN (R 4.2.0) ## withr 2.5.0 2022-03-03 [1] CRAN (R 4.2.0) ## xfun 0.31 2022-05-10 [1] CRAN (R 4.2.0) ## xml2 1.3.3 2021-11-30 [1] CRAN (R 4.2.0) ## yaml 2.3.5 2022-02-21 [1] CRAN (R 4.2.0) ## ## [1] C:/Users/seldenjrz/AppData/Local/R/win-library/4.2 ## [2] C:/Program Files/R/R-4.2.0/library ## ## ──────────────────────────────────────────────────────────────────────── Current Git commit details are: # where can I find this commit? if (&quot;git2r&quot; %in% installed.packages() &amp; git2r::in_repository(path = &quot;.&quot;)) git2r::repository(here::here()) ## Local: master E:/github/jowell.1 ## Remote: master @ origin (https://github.com/seldenlab/jowell.1) ## Head: [9b00261] 2022-07-04: &lt;edit index&gt; References "],["linear-metrics-by-site.html", "Chapter 1 Linear metrics by site 1.1 Load data + define L/S 1.2 Boxplots for variable by site 1.3 Principal Components Analysis for site 1.4 Analyses of Variance (ANOVA) for variable ~ site", " Chapter 1 Linear metrics by site # install required analysis packages #devtools::install_github(&quot;tidyverse/tidyverse&quot;) #devtools::install_github(&quot;mlcollyer/RRPP&quot;) #devtools::install_github(&quot;kassambara/ggpubr&quot;) #devtools::install_github(&quot;sinhrks/ggfortify&quot;) #devtools::install_github(&quot;karthik/wesanderson&quot;) #devtools::install_github(&quot;daattali/ggExtra&quot;) # load libraries library(here) library(tidyverse) library(RRPP) library(ggpubr) library(ggfortify) library(cluster) library(wesanderson) library(ggExtra) 1.1 Load data + define L/S # define subsets, assign L/S---- # load data DATA &lt;- read.csv(&quot;linear.csv&quot;, header = TRUE, as.is=TRUE) #select vars pre.data &lt;- DATA %&gt;% select(spec:thickness) # hs261 subset---- hs261 &lt;- subset(pre.data, site == &quot;41HS261&quot;, select = spec:thickness) ## histogram of max length hist(hs261$length) # calculate the mean length meanl &lt;- mean(hs261$length) # assign L/S varieties based on mean length lcheck2 &lt;- hs261$length &gt;= meanl lcheck3 &lt;- hs261$length &gt;= 0 &amp; hs261$length &lt; meanl hs261$size &lt;- &quot;&quot; hs261$size &lt;- ifelse(lcheck2, &quot;L&quot;, hs261$size) hs261$size &lt;- ifelse(lcheck3, &quot;S&quot;, hs261$size) # an13 subset---- an13 &lt;- subset(pre.data, site == &quot;41AN13&quot;, select = spec:thickness) ## histogram of max length hist(an13$length) # calculate the mean length meanl &lt;- mean(an13$length) # assign L/S varieties based on mean length lcheck2 &lt;- an13$length &gt;= meanl lcheck3 &lt;- an13$length &gt;= 0 &amp; an13$length &lt; meanl an13$size &lt;- &quot;&quot; an13$size &lt;- ifelse(lcheck2, &quot;L&quot;, an13$size) an13$size &lt;- ifelse(lcheck3, &quot;S&quot;, an13$size) # aggregate data mx &lt;- bind_rows(hs261, an13) # join site and size class qdata &lt;- mx %&gt;% unite(&quot;merged&quot;, site, size, remove = FALSE) 1.2 Boxplots for variable by site # boxplot of maximum length ~ site sitemaxl &lt;- ggplot(qdata, aes(x = merged, y = length, color = merged)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;, stackdir = &#39;center&#39;, dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + theme(legend.position = &quot;none&quot;) + labs(x = &#39;Site&#39;, y = &#39;MaxL&#39;) # boxplot of maximum width ~ site sitemaxw &lt;- ggplot(qdata, aes(x = merged, y = width, color = merged)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;, stackdir = &#39;center&#39;, dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + theme(legend.position = &quot;none&quot;) + labs(x = &#39;Site&#39;, y = &#39;MaxW&#39;) # boxplot of maximum thickness ~ site sitemaxth &lt;- ggplot(qdata, aes(x = merged, y = thickness, color = merged)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;, stackdir = &#39;center&#39;, dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + theme(legend.position = &quot;none&quot;) + labs(x = &#39;Site&#39;, y = &#39;MaxTh&#39;) # render figure sitefigure&lt;-ggarrange(sitemaxl,sitemaxw,sitemaxth, labels = c(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;), ncol = 2, nrow = 2) ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. # plot figure sitefigure Figure 1.1: Boxplots for maximum length, width, and thickness for Jowell knives from 41AN13 and 41HS261. 1.3 Principal Components Analysis for site #attributes for plot merged &lt;- qdata$merged df &lt;- qdata[c(4:6)] pch.gps.gp &lt;- c(15:18)[as.factor(merged)] #pca pca &lt;- autoplot(prcomp(df), data = qdata, asp = 1, shape = pch.gps.gp, colour = &#39;merged&#39;, loadings = TRUE, loadings.colour = &#39;blue&#39;, loadings.label = TRUE, loadings.label.size = 3, frame = TRUE) + scale_fill_manual(values = wes_palette(&quot;Moonrise2&quot;)) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) ggMarginal(pca, groupColour = TRUE, groupFill = TRUE) Figure 1.2: Principal Components Analysis by site. 1.4 Analyses of Variance (ANOVA) for variable ~ site 1.4.1 Maximum length of Jowell knives # anova = maximum length ~ site siteml &lt;- lm.rrpp(length ~ merged, SS.type = &quot;I&quot;, data = qdata, iter = 9999, print.progress = FALSE) # difference in max length by size class? anova(siteml) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## merged 3 3909.6 1303.21 0.73264 31.056 6.6864 1e-04 *** ## Residuals 34 1426.8 41.96 0.26736 ## Total 37 5336.4 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: lm.rrpp(f1 = length ~ merged, iter = 9999, SS.type = &quot;I&quot;, data = qdata, ## print.progress = FALSE) # pairwise comparison of LS means = which differ? sh.pwml &lt;- pairwise(siteml, groups = qdata$merged) summary(sh.pwml, confidence = 0.95, test.type = &quot;dist&quot;) ## ## Pairwise comparisons ## ## Groups: 41AN13_L 41AN13_S 41HS261_L 41HS261_S ## ## RRPP: 10000 permutations ## ## LS means: ## Vectors hidden (use show.vectors = TRUE to view) ## ## Pairwise distances between means, plus statistics ## d UCL (95%) Z Pr &gt; d ## 41AN13_L:41AN13_S 22.0785714 12.989750 2.7048557 0.0004 ## 41AN13_L:41HS261_L 2.3327381 11.155345 -0.5160828 0.6886 ## 41AN13_L:41HS261_S 21.5162637 11.006445 3.0235298 0.0001 ## 41AN13_S:41HS261_L 19.7458333 11.823750 2.6473327 0.0004 ## 41AN13_S:41HS261_S 0.5623077 11.618917 -1.5460158 0.9263 ## 41HS261_L:41HS261_S 19.1835256 9.342731 3.1528869 0.0001 1.4.2 Maximum width of Jowell knives # anova = maximum width ~ site sitemw &lt;- lm.rrpp(width ~ merged, SS.type = &quot;I&quot;, data = qdata, iter = 9999, print.progress = FALSE) anova(sitemw) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## merged 3 9.902 3.3008 0.17992 2.4865 1.4114 0.0799 . ## Residuals 34 45.134 1.3275 0.82008 ## Total 37 55.037 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: lm.rrpp(f1 = width ~ merged, iter = 9999, SS.type = &quot;I&quot;, data = qdata, ## print.progress = FALSE) 1.4.3 Maximum thickness of Jowell knives # anova = maximum thickness ~ site sitemth &lt;- lm.rrpp(thickness ~ merged, SS.type = &quot;I&quot;, data = qdata, iter = 9999, print.progress = FALSE) # difference in max thickness by size class? anova(sitemth) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## merged 3 16.092 5.3642 0.50036 11.35 3.9965 1e-04 *** ## Residuals 34 16.069 0.4726 0.49964 ## Total 37 32.162 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: lm.rrpp(f1 = thickness ~ merged, iter = 9999, SS.type = &quot;I&quot;, ## data = qdata, print.progress = FALSE) # pairwise comparison of LS means = which differ? sh.pwmth &lt;- pairwise(sitemth, groups = qdata$merged) summary(sh.pwmth, confidence = 0.95, test.type = &quot;dist&quot;) ## ## Pairwise comparisons ## ## Groups: 41AN13_L 41AN13_S 41HS261_L 41HS261_S ## ## RRPP: 10000 permutations ## ## LS means: ## Vectors hidden (use show.vectors = TRUE to view) ## ## Pairwise distances between means, plus statistics ## d UCL (95%) Z Pr &gt; d ## 41AN13_L:41AN13_S 0.2571429 1.0145238 -0.3271927 0.6291 ## 41AN13_L:41HS261_L 1.4345238 0.8578810 2.6416538 0.0011 ## 41AN13_L:41HS261_S 0.9374725 0.8527857 1.7651662 0.0307 ## 41AN13_S:41HS261_L 1.6916667 0.9183333 2.8854375 0.0001 ## 41AN13_S:41HS261_S 1.1946154 0.9027756 2.1472914 0.0076 ## 41HS261_L:41HS261_S 0.4970513 0.7220577 0.9392420 0.1857 "],["geometric-morphometrics-1.html", "Chapter 2 Geometric morphometrics 2.1 Load packages + data 2.2 Generalised Procrustes Analysis 2.3 Principal Components Analysis 2.4 ANOVA 2.5 Trajectory Analysis 2.6 Morphological Disparity 2.7 Mean Shapes", " Chapter 2 Geometric morphometrics 2.1 Load packages + data # load required analysis packages library(here) library(StereoMorph) library(geomorph) ## Loading required package: rgl ## Loading required package: Matrix ## ## Attaching package: &#39;Matrix&#39; ## The following objects are masked from &#39;package:tidyr&#39;: ## ## expand, pack, unpack library(tidyverse) library(wesanderson) library(ggplot2) # read data and define number of sLMs ---- shapes &lt;- readShapes(&quot;shapes&quot;) shapesGM &lt;- readland.shapes(shapes, nCurvePts = c(50,50)) # read qualitative data qdata &lt;- read.csv(&quot;qdata.morph.csv&quot;, header = TRUE, row.names = 1) 2.2 Generalised Procrustes Analysis # gpa ---- Y.gpa &lt;- gpagen(shapesGM, print.progress = FALSE) # geomorph data frame ---- gdf &lt;- geomorph.data.frame(shape = Y.gpa$coords, size = Y.gpa$Csize, merged = qdata$merged) # add centroid size to qdata qdata$csz &lt;- Y.gpa$Csize # attributes for boxplot csz &lt;- qdata$csz # centroid size site &lt;- qdata$site # site # boxplot of Jowell knife centroid size by site ---- csz.site &lt;- ggplot(qdata, aes(x = merged, y = csz, color = merged)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;, stackdir = &#39;center&#39;, dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + theme(legend.position = &quot;none&quot;) + labs(x = &#39;Site&#39;, y = &#39;Centroid Size&#39;) # render boxplot csz.site ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. 2.3 Principal Components Analysis # principal components analysis ---- pca&lt;-gm.prcomp(Y.gpa$coords) summary(pca) ## ## Ordination type: Principal Component Analysis ## Centering by OLS mean ## Orthogonal projection of OLS residuals ## Number of observations: 35 ## Number of vectors 34 ## ## Importance of Components: ## Comp1 Comp2 Comp3 ## Eigenvalues 0.0005893846 0.0002562312 0.0001945825 ## Proportion of Variance 0.5135328039 0.2232551552 0.1695404078 ## Cumulative Proportion 0.5135328039 0.7367879591 0.9063283669 ## Comp4 Comp5 Comp6 ## Eigenvalues 3.486351e-05 2.283077e-05 2.039902e-05 ## Proportion of Variance 3.037669e-02 1.989253e-02 1.777373e-02 ## Cumulative Proportion 9.367051e-01 9.565976e-01 9.743713e-01 ## Comp7 Comp8 Comp9 ## Eigenvalues 9.053899e-06 7.151691e-06 3.951494e-06 ## Proportion of Variance 7.888693e-03 6.231293e-03 3.442950e-03 ## Cumulative Proportion 9.822600e-01 9.884913e-01 9.919343e-01 ## Comp10 Comp11 Comp12 ## Eigenvalues 3.511402e-06 1.669871e-06 1.118780e-06 ## Proportion of Variance 3.059497e-03 1.454965e-03 9.747971e-04 ## Cumulative Proportion 9.949938e-01 9.964487e-01 9.974235e-01 ## Comp13 Comp14 Comp15 ## Eigenvalues 8.840868e-07 4.867142e-07 3.906184e-07 ## Proportion of Variance 7.703079e-04 4.240757e-04 3.403472e-04 ## Cumulative Proportion 9.981938e-01 9.986179e-01 9.989582e-01 ## Comp16 Comp17 Comp18 ## Eigenvalues 2.504768e-07 2.113307e-07 1.681332e-07 ## Proportion of Variance 2.182413e-04 1.841332e-04 1.464950e-04 ## Cumulative Proportion 9.991765e-01 9.993606e-01 9.995071e-01 ## Comp19 Comp20 Comp21 ## Eigenvalues 1.342370e-07 9.423121e-08 8.369514e-08 ## Proportion of Variance 1.169612e-04 8.210398e-05 7.292387e-05 ## Cumulative Proportion 9.996241e-01 9.997062e-01 9.997791e-01 ## Comp22 Comp23 Comp24 ## Eigenvalues 5.521749e-08 4.734244e-08 3.482840e-08 ## Proportion of Variance 4.811119e-05 4.124963e-05 3.034610e-05 ## Cumulative Proportion 9.998272e-01 9.998685e-01 9.998988e-01 ## Comp25 Comp26 Comp27 ## Eigenvalues 2.344419e-08 2.201045e-08 1.819884e-08 ## Proportion of Variance 2.042701e-05 1.917778e-05 1.585672e-05 ## Cumulative Proportion 9.999192e-01 9.999384e-01 9.999543e-01 ## Comp28 Comp29 Comp30 ## Eigenvalues 1.465394e-08 1.252782e-08 9.388193e-09 ## Proportion of Variance 1.276803e-05 1.091553e-05 8.179965e-06 ## Cumulative Proportion 9.999670e-01 9.999780e-01 9.999861e-01 ## Comp31 Comp32 Comp33 ## Eigenvalues 5.509947e-09 4.984338e-09 3.041121e-09 ## Proportion of Variance 4.800836e-06 4.342871e-06 2.649739e-06 ## Cumulative Proportion 9.999909e-01 9.999953e-01 9.999979e-01 ## Comp34 ## Eigenvalues 2.371547e-09 ## Proportion of Variance 2.066337e-06 ## Cumulative Proportion 1.000000e+00 # set plot parameters pch.gps &lt;- c(1:4)[as.factor(qdata$merged)] col.gps &lt;- wes_palette(&quot;Moonrise2&quot;)[as.factor(qdata$merged)] col.hull &lt;- c(&quot;#CCC591&quot;, &quot;#29211F&quot;, &quot;#798E87&quot;, &quot;#C27D38&quot;) # plot pca by site pc.plot &lt;- plot(pca, asp = 1, pch = pch.gps, col = col.gps) shapeHulls(pc.plot, groups = qdata$merged, group.cols = col.hull) 2.4 ANOVA # ANOVA ---- # size fit.sz &lt;- procD.lm(size ~ merged, data = gdf, print.progress = FALSE, iter = 9999) anova(fit.sz) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## merged 3 317.28 105.761 0.7379 29.092 6.1213 1e-04 *** ## Residuals 31 112.70 3.635 0.2621 ## Total 34 429.98 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = size ~ merged, iter = 9999, data = gdf, print.progress = FALSE) # pairwise comparison of LS means = which differ? pw.sz &lt;- pairwise(fit.sz, groups = qdata$merged) summary(pw.sz, confidence = 0.95, test.type = &quot;dist&quot;) ## ## Pairwise comparisons ## ## Groups: AN13_L AN13_S HS261_L HS261_S ## ## RRPP: 10000 permutations ## ## LS means: ## Vectors hidden (use show.vectors = TRUE to view) ## ## Pairwise distances between means, plus statistics ## d UCL (95%) Z Pr &gt; d ## AN13_L:AN13_S 6.085943 4.182363 2.3154486 0.0042 ## AN13_L:HS261_L 1.925142 3.490613 0.6378125 0.2816 ## AN13_L:HS261_S 7.514958 3.460303 3.2703517 0.0001 ## AN13_S:HS261_L 4.160801 3.697289 1.7987390 0.0260 ## AN13_S:HS261_S 1.429015 3.692590 0.1602836 0.4560 ## HS261_L:HS261_S 5.589816 2.831037 2.9926618 0.0001 # shape fit.sh &lt;- procD.lm(shape ~ merged, data = gdf, print.progress = FALSE, iter = 9999) anova(fit.sh) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## merged 3 0.006360 0.0021199 0.16298 2.012 1.6912 0.0445 * ## Residuals 31 0.032662 0.0010536 0.83702 ## Total 34 0.039022 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = shape ~ merged, iter = 9999, data = gdf, print.progress = FALSE) # pairwise comparison of LS means = which differ? pw.sh &lt;- pairwise(fit.sh, groups = qdata$merged) summary(pw.sh, confidence = 0.95, test.type = &quot;dist&quot;) ## ## Pairwise comparisons ## ## Groups: AN13_L AN13_S HS261_L HS261_S ## ## RRPP: 10000 permutations ## ## LS means: ## Vectors hidden (use show.vectors = TRUE to view) ## ## Pairwise distances between means, plus statistics ## d UCL (95%) Z Pr &gt; d ## AN13_L:AN13_S 0.02259987 0.03270278 0.5920542 0.2840 ## AN13_L:HS261_L 0.03150646 0.02669895 2.1749117 0.0139 ## AN13_L:HS261_S 0.02818601 0.02668022 1.7894766 0.0349 ## AN13_S:HS261_L 0.02149886 0.02888290 0.7779671 0.2244 ## AN13_S:HS261_S 0.01129906 0.02863180 -0.8657161 0.7993 ## HS261_L:HS261_S 0.01732148 0.02213425 0.9255984 0.1849 2.5 Trajectory Analysis # trajectory analysis::shape---- TA &lt;- trajectory.analysis(fit.sh, groups = qdata$site, traj.pts = qdata$size, print.progress = FALSE) # magnitude difference summary(TA, attribute = &quot;MD&quot;, show.trajectories = TRUE) ## ## Trajectory analysis ## ## 10000 permutations. ## ## Points projected onto trajectory PCs ## ## Trajectories: ## $AN13 ## PC1 PC2 PC3 PC4 PC5 ## AN13.L 0.021509873 0.006293935 -0.001300803 -1.511547e-16 -9.506441e-17 ## AN13.S 0.004770784 -0.007012931 0.006012485 1.539559e-16 1.269969e-16 ## PC6 PC7 PC8 PC9 ## AN13.L 1.437694e-16 -8.112882e-18 -1.903707e-17 1.528047e-17 ## AN13.S -1.709008e-16 -4.709588e-17 6.291761e-18 -9.378349e-18 ## PC10 PC11 PC12 PC13 ## AN13.L 4.378779e-17 -1.320810e-17 -3.446566e-17 2.577310e-18 ## AN13.S 6.935506e-18 -2.961418e-17 -3.710693e-17 -6.993951e-18 ## PC14 PC15 PC16 PC17 ## AN13.L 6.026639e-18 2.818883e-17 3.811655e-18 -1.360758e-17 ## AN13.S -1.767419e-17 -2.284278e-17 -1.340968e-17 1.772840e-18 ## PC18 PC19 PC20 PC21 ## AN13.L 4.959166e-18 -3.990372e-18 -5.987252e-18 3.082183e-17 ## AN13.S 6.104566e-18 -1.093562e-17 1.100253e-17 -3.262347e-17 ## PC22 PC23 PC24 PC25 ## AN13.L -2.425521e-17 1.215958e-17 6.149671e-18 -1.062560e-17 ## AN13.S 2.563429e-17 3.020519e-18 8.733757e-18 5.138102e-18 ## PC26 PC27 PC28 PC29 ## AN13.L -1.181823e-18 -2.387151e-18 1.006226e-18 6.408651e-18 ## AN13.S 1.412004e-17 9.250447e-18 1.777770e-18 -9.222495e-18 ## PC30 PC31 PC32 PC33 ## AN13.L 7.019786e-19 -1.983751e-18 5.041011e-18 1.356947e-18 ## AN13.S -7.838443e-18 7.165899e-19 3.606560e-18 -1.565317e-18 ## PC34 PC35 ## AN13.L -3.086270e-18 -1.530165e-18 ## AN13.S 2.931793e-19 2.037114e-19 ## ## $HS261 ## PC1 PC2 PC3 PC4 ## HS261.L -0.009917818 0.007667661 0.0004513587 -1.234538e-16 ## HS261.S -0.002824945 -0.007892574 -0.0023061591 2.603794e-16 ## PC5 PC6 PC7 PC8 ## HS261.L -1.287780e-16 1.590143e-16 4.822582e-18 4.314871e-17 ## HS261.S 2.285655e-16 -3.068351e-16 1.006614e-17 2.530087e-18 ## PC9 PC10 PC11 PC12 ## HS261.L 3.438615e-17 4.546958e-17 -2.482325e-17 -4.353845e-17 ## HS261.S 2.204319e-17 4.395254e-18 7.774598e-17 1.185110e-17 ## PC13 PC14 PC15 PC16 ## HS261.L -1.773263e-18 7.443302e-18 1.561293e-17 -7.409533e-18 ## HS261.S 9.147956e-20 -5.196357e-17 -2.270175e-17 -2.863266e-17 ## PC17 PC18 PC19 PC20 ## HS261.L -4.199208e-17 -3.023749e-18 2.035346e-17 1.989469e-17 ## HS261.S 9.178449e-18 2.183519e-17 -3.423824e-17 -5.753471e-19 ## PC21 PC22 PC23 PC24 ## HS261.L -6.277361e-18 9.007825e-18 2.012889e-17 -9.583331e-18 ## HS261.S -1.094731e-16 3.221362e-17 7.640237e-19 2.431821e-17 ## PC25 PC26 PC27 PC28 ## HS261.L -1.405439e-17 -1.677676e-17 -4.946672e-18 -2.447045e-17 ## HS261.S 1.451137e-17 2.302066e-17 1.147370e-17 2.531796e-17 ## PC29 PC30 PC31 PC32 ## HS261.L 6.140142e-18 -2.195086e-18 -5.995723e-18 -7.189033e-18 ## HS261.S -2.120462e-17 -1.100190e-17 5.115232e-18 3.683958e-18 ## PC33 PC34 PC35 ## HS261.L 6.601351e-18 3.569450e-18 1.212083e-17 ## HS261.S 2.456396e-19 -1.020537e-17 -7.578827e-18 ## ## ## Observed path distances by group ## ## AN13 HS261 ## 0.02259987 0.01732148 ## ## Pairwise absolute differences in path distances, plus statistics ## d UCL (95%) Z Pr &gt; d ## AN13:HS261 0.005278387 0.02036483 -0.1748349 0.5729 # plot TP &lt;- plot(TA, pch = as.numeric(qdata$site), bg = as.numeric(qdata$size), cex = 0.9, col = &quot;gray&quot;) add.trajectories(TP, traj.pch = c(1,2), traj.cex = 1) 2.6 Morphological Disparity # morphological disparity ---- # do any of the groups display greater shape variation among # individuals relative to the other group? morphol.disparity(shape ~ merged, groups = qdata$merged, data = gdf, print.progress = FALSE, iter = 9999) ## ## Call: ## morphol.disparity(f1 = shape ~ merged, groups = qdata$merged, ## iter = 9999, data = gdf, print.progress = FALSE) ## ## ## ## Randomized Residual Permutation Procedure Used ## 10000 Permutations ## ## Procrustes variances for defined groups ## AN13_L AN13_S HS261_L HS261_S ## 0.0020256692 0.0006126342 0.0006043884 0.0008493661 ## ## ## Pairwise absolute differences between variances ## AN13_L AN13_S HS261_L HS261_S ## AN13_L 0.000000000 1.413035e-03 1.421281e-03 0.0011763030 ## AN13_S 0.001413035 0.000000e+00 8.245811e-06 0.0002367319 ## HS261_L 0.001421281 8.245811e-06 0.000000e+00 0.0002449777 ## HS261_S 0.001176303 2.367319e-04 2.449777e-04 0.0000000000 ## ## ## P-Values ## AN13_L AN13_S HS261_L HS261_S ## AN13_L 1e+00 0.0005 0.0001 0.0009 ## AN13_S 5e-04 1.0000 0.9846 0.5592 ## HS261_L 1e-04 0.9846 1.0000 0.4486 ## HS261_S 9e-04 0.5592 0.4486 1.0000 2.7 Mean Shapes # mean shapes ---- # subset landmark coordinates to produce mean shapes new.coords&lt;-coords.subset(A = Y.gpa$coords, group = qdata$merged) names(new.coords) ## [1] &quot;AN13_L&quot; &quot;AN13_S&quot; &quot;HS261_L&quot; &quot;HS261_S&quot; # group shape means mean &lt;- lapply(new.coords, mshape) # comparison plots plotRefToTarget(mean$AN13_L, mean$HS261_L, method = c(&quot;point&quot;), mag = 2) "],["references.html", "References", " References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
